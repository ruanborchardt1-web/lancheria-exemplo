<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçî Sistema de Pedidos da Lancheria</title>
    
    <style>
        /* Estilos Comuns */
        body { font-family: sans-serif; margin: 0; padding: 20px; background-color: #f4f4f4; }
        .container { max-width: 1200px; margin: 0 auto; background-color: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #d9534f; margin-bottom: 30px; }
        .adicionar-btn, .btn-confirmar { background-color: #007bff; color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer; transition: background-color 0.3s; }
        .adicionar-btn:hover, .btn-confirmar:hover { background-color: #0056b3; }
        .btn-confirmar { background-color: #4CAF50; padding: 15px 25px; font-size: 1.2em; width: 100%; margin-top: 20px; }

        /* Estilos do Card√°pio */
        header { padding-bottom: 20px; }
        .categoria { margin-top: 30px; border-bottom: 2px solid #ddd; padding-bottom: 15px; }
        .categoria h2 { color: #d9534f; border-left: 5px solid #d9534f; padding-left: 10px; margin-bottom: 20px; }
        .item { display: flex; align-items: center; justify-content: space-between; padding: 15px 0; border-bottom: 1px dashed #eee; }
        .item-info { flex-grow: 1; }
        .item-info h3 { margin: 0 0 5px 0; font-size: 1.2em; }
        .item-info p { margin: 0; color: #666; font-size: 0.9em; }
        .item-preco { font-size: 1.3em; font-weight: bold; color: #4CAF50; margin-right: 20px; }
        #carrinho-visual { border: 1px solid #ccc; background-color: #fafafa; }
        #lista-itens-carrinho { max-height: 200px; overflow-y: auto; }

        /* Estilos do Checkout */
        .checkout-container { max-width: 800px; margin: 0 auto; background-color: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .secao { margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px dashed #ccc; }
        .secao h2 { color: #007bff; margin-top: 0; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-group input, .form-group select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .botoes-pagamento { display: flex; gap: 15px; margin-top: 10px; }
        .botoes-pagamento label { padding: 10px 15px; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; flex-grow: 1; text-align: center; }
        .botoes-pagamento input[type="radio"]:checked + label { border-color: #d9534f; background-color: #ffe0df; font-weight: bold; }
        .botoes-pagamento input[type="radio"] { display: none; }
        #troco-field { display: none; margin-top: 15px; }
        .resumo-pedido { background-color: #fafafa; padding: 15px; border-radius: 4px; }
        .total-final { font-size: 1.8em; font-weight: bold; color: #4CAF50; text-align: right; margin-top: 20px; }
        .btn-voltar { display: block; text-align: center; margin-top: 15px; color: #007bff; text-decoration: none; }
    </style>
</head>
<body>

    <div id="pagina-cardapio" class="container">
        <header>
            <h1>Bem-vindo(a) √† Lancheria!</h1>
            <p>Seu pedido r√°pido e fresquinho na sua casa.</p>
        </header>

        <section id="carrinho-visual" style="margin-bottom: 30px; padding: 15px; border-radius: 4px; display: none;">
            <h2>üõí Seu Pedido</h2>
            <div id="lista-itens-carrinho">
                </div>
            <div style="text-align: right; margin-top: 15px;">
                <p style="font-size: 1.4em; font-weight: bold;">Subtotal: <span id="carrinho-total">R$ 0,00</span></p>
                <button id="btn-checkout" class="adicionar-btn" style="background-color: #d9534f; font-size: 1.1em;" disabled>
                    Finalizar Pedido ‚Üí
                </button>
            </div>
        </section>

        <div class="categoria" id="lanches">
            <h2>üçî Lanches Especiais</h2>
            <div class="item"><div class="item-info"><h3>Super Cl√°ssico</h3><p>P√£o de brioche, 200g de carne, queijo cheddar, bacon crocante, alface e maionese da casa.</p></div><div class="item-preco">R$ 35,90</div><button class="adicionar-btn" data-item-id="1">Adicionar</button></div>
            <div class="item"><div class="item-info"><h3>Vegetariano Deluxe</h3><p>P√£o integral, hamb√∫rguer de gr√£o de bico, queijo coalho grelhado e r√∫cula.</p></div><div class="item-preco">R$ 29,90</div><button class="adicionar-btn" data-item-id="2">Adicionar</button></div>
        </div>

        <div class="categoria" id="acompanhamentos">
            <h2>üçü Acompanhamentos</h2>
            <div class="item"><div class="item-info"><h3>Batata Frita R√∫stica</h3><p>Por√ß√£o de batata r√∫stica com alecrim e alho.</p></div><div class="item-preco">R$ 18,00</div><button class="adicionar-btn" data-item-id="3">Adicionar</button></div>
        </div>

        <div class="categoria" id="bebidas">
            <h2>ü•§ Bebidas</h2>
            <div class="item"><div class="item-info"><h3>Refrigerante Lata</h3><p>Coca-cola, Guaran√°, Soda (350ml).</p></div><div class="item-preco">R$ 6,00</div><button class="adicionar-btn" data-item-id="5">Adicionar</button></div>
        </div>
        
    </div>

    <div id="pagina-checkout" class="checkout-container" style="display: none;">
        <h1>üîí Finalizar Pedido</h1>
        
        <form id="checkout-form">
            
            <div class="secao resumo-pedido">
                <h2>üì¶ Itens no Carrinho</h2>
                <div id="resumo-carrinho-itens"></div>
                <div class="total-final">Total a Pagar: <span id="total-final-checkout">R$ 0,00</span></div>
            </div>

            <div class="secao">
                <h2>üìç Endere√ßo de Entrega</h2>
                <div class="form-group"><label for="cep">CEP:</label><input type="text" id="cep" name="cep" required placeholder="Ex: 01001-000"></div>
                <div class="form-group"><label for="rua">Rua:</label><input type="text" id="rua" name="rua" required></div>
                <div style="display: flex; gap: 15px;"><div class="form-group" style="flex: 1;"><label for="numero">N√∫mero:</label><input type="text" id="numero" name="numero" required></div>
                    <div class="form-group" style="flex: 2;"><label for="complemento">Complemento / Apto:</label><input type="text" id="complemento" name="complemento"></div></div>
                <div class="form-group"><label for="referencia">Ponto de Refer√™ncia (Opcional):</label><input type="text" id="referencia" name="referencia"></div>
            </div>

            <div class="secao">
                <h2>üí∞ Forma de Pagamento</h2>
                <div class="botoes-pagamento">
                    <div><input type="radio" id="pagamento-pix" name="pagamento" value="pix" required><label for="pagamento-pix">Pix</label></div>
                    <div><input type="radio" id="pagamento-cartao-entrega" name="pagamento" value="cartao_entrega" required><label for="pagamento-cartao-entrega">Cart√£o na Entrega</label></div>
                    <div><input type="radio" id="pagamento-dinheiro" name="pagamento" value="dinheiro" required><label for="pagamento-dinheiro">Dinheiro</label></div>
                </div>
                <div id="troco-field" class="form-group">
                    <label for="troco">Precisa de troco para quanto?</label>
                    <input type="number" id="troco" name="troco" placeholder="Valor em dinheiro (Ex: 50)">
                </div>
            </div>

            <button type="submit" class="btn-confirmar">‚úÖ Confirmar Pedido</button>
            <button type="button" id="btn-voltar-cardapio" class="btn-voltar" style="border: none; background: transparent;">‚Üê Voltar ao Card√°pio</button>
        </form>
    </div>

    <script>
        const STORAGE_KEY = 'lancheriaCarrinho';
        
        // DADOS DO CARD√ÅPIO
        const CARDAPIO_ITENS = [
            { id: 1, nome: "Super Cl√°ssico", preco: 35.90 },
            { id: 2, nome: "Vegetariano Deluxe", preco: 29.90 },
            { id: 3, nome: "Batata Frita R√∫stica", preco: 18.00 },
            { id: 4, nome: "An√©is de Cebola", preco: 22.50 },
            { id: 5, nome: "Refrigerante Lata", preco: 6.00 },
        ];
        
        // VARI√ÅVEL GLOBAL PARA O CARRINHO (Carrega do LocalStorage)
        let carrinho = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];

        // Elementos de Navega√ß√£o
        const paginaCardapio = document.getElementById('pagina-cardapio');
        const paginaCheckout = document.getElementById('pagina-checkout');
        
        /* ---------------------- L√ìGICA DO CARRINHO ---------------------- */

        const salvarCarrinho = () => {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(carrinho));
        };

        const encontrarItemNoCarrinho = (itemId) => {
            return carrinho.find(item => item.item_id === itemId);
        };

        const adicionarAoCarrinho = (itemId) => {
            const produto = CARDAPIO_ITENS.find(p => p.id === itemId);
            if (!produto) return;

            const itemExistente = encontrarItemNoCarrinho(itemId);

            if (itemExistente) {
                itemExistente.quantidade += 1;
            } else {
                carrinho.push({
                    item_id: produto.id,
                    nome: produto.nome,
                    preco: produto.preco,
                    quantidade: 1
                });
            }

            salvarCarrinho();
            renderizarCarrinho();
        };

        const renderizarCarrinho = () => {
            const listaItensHtml = document.getElementById('lista-itens-carrinho');
            const carrinhoVisual = document.getElementById('carrinho-visual');
            const carrinhoTotalSpan = document.getElementById('carrinho-total');
            const btnCheckout = document.getElementById('btn-checkout');
            
            let total = 0;
            let htmlContent = '';

            if (carrinho.length === 0) {
                carrinhoVisual.style.display = 'none';
                btnCheckout.disabled = true;
            } else {
                carrinhoVisual.style.display = 'block';
                btnCheckout.disabled = false;
                
                carrinho.forEach(item => {
                    const subtotal = item.preco * item.quantidade;
                    total += subtotal;
                    
                    htmlContent += `
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 5px 0; border-bottom: 1px dotted #eee;">
                            <span><strong style="color: #d9534f;">${item.quantidade}x</strong> ${item.nome}</span>
                            <span>R$ ${subtotal.toFixed(2)}</span>
                        </div>
                    `;
                });
            }

            listaItensHtml.innerHTML = htmlContent || '<p style="margin: 0; padding: 10px;">O carrinho est√° vazio.</p>';
            carrinhoTotalSpan.textContent = `R$ ${total.toFixed(2)}`;
            
            // Configura o bot√£o de checkout
            btnCheckout.onclick = irParaCheckout; 
        };

        /* ---------------------- L√ìGICA DE NAVEGA√á√ÉO ---------------------- */

        const irParaCheckout = () => {
            if (carrinho.length === 0) return;
            paginaCardapio.style.display = 'none';
            paginaCheckout.style.display = 'block';
            carregarResumoCarrinho(); // Carrega os dados na tela de checkout
        };

        const irParaCardapio = () => {
            paginaCheckout.style.display = 'none';
            paginaCardapio.style.display = 'block';
            renderizarCarrinho(); // Garante que o carrinho no card√°pio esteja atualizado
        };
        
        /* ---------------------- L√ìGICA DO CHECKOUT ---------------------- */

        const carregarResumoCarrinho = () => {
            const resumoDiv = document.getElementById('resumo-carrinho-itens');
            const totalSpan = document.getElementById('total-final-checkout');
            
            let htmlContent = '';
            let total = 0;

            if (carrinho.length === 0) {
                // Redireciona de volta se o carrinho estiver vazio no checkout
                irParaCardapio(); 
                return;
            }

            carrinho.forEach(item => {
                const subtotal = item.preco * item.quantidade;
                total += subtotal;
                htmlContent += `
                    <div style="display: flex; justify-content: space-between; font-size: 1.1em; padding: 3px 0;">
                        <span>${item.quantidade}x ${item.nome}</span>
                        <span>R$ ${subtotal.toFixed(2)}</span>
                    </div>
                `;
            });

            resumoDiv.innerHTML = htmlContent;
            totalSpan.textContent = `R$ ${total.toFixed(2)}`;
        };

        const configurarPagamento = () => {
            const trocoField = document.getElementById('troco-field');
            const radioPagamento = document.querySelectorAll('input[name="pagamento"]');
            const trocoInput = document.getElementById('troco');

            radioPagamento.forEach(radio => {
                radio.addEventListener('change', () => {
                    if (radio.value === 'dinheiro') {
                        trocoField.style.display = 'block';
                        trocoInput.setAttribute('required', 'required');
                    } else {
                        trocoField.style.display = 'none';
                        trocoInput.removeAttribute('required');
                        trocoInput.value = '';
                    }
                });
            });
        };

        const lidarComEnvioDoFormulario = (event) => {
            event.preventDefault(); 
            
            // Simula√ß√£o de envio
            const form = event.target;
            const dadosPedido = {
                itens: carrinho,
                endereco: {
                    cep: form.cep.value,
                    rua: form.rua.value,
                    numero: form.numero.value,
                    complemento: form.complemento.value,
                    referencia: form.referencia.value,
                },
                pagamento: {
                    metodo: form.pagamento.value,
                    troco_para: form.pagamento.value === 'dinheiro' ? form.troco.value : null
                },
                total: document.getElementById('total-final-checkout').textContent.replace('R$ ', '').replace(',', '.')
            };

            // LOGICA DE ENVIO (SERIA PARA O BACKEND AQUI)
            console.log("PEDIDO ENVIADO:", dadosPedido);
            
            // Limpa o carrinho
            carrinho = [];
            localStorage.removeItem(STORAGE_KEY);

            // Confirma√ß√£o
            alert("üéâ Pedido Recebido com Sucesso! Seu lanche ser√° entregue no endere√ßo fornecido.");
            
            // Volta para a tela inicial
            irParaCardapio(); 
        };
        
        /* ---------------------- INICIALIZA√á√ÉO ---------------------- */

        const inicializarApp = () => {
            // Configura√ß√£o dos bot√µes de adicionar
            document.querySelectorAll('.adicionar-btn').forEach(botao => {
                botao.addEventListener('click', (event) => {
                    adicionarAoCarrinho(parseInt(event.target.dataset.itemId));
                });
            });

            // Configura√ß√£o do formul√°rio de checkout
            const checkoutForm = document.getElementById('checkout-form');
            if(checkoutForm) {
                checkoutForm.addEventListener('submit', lidarComEnvioDoFormulario);
                configurarPagamento();
            }

            // Configura√ß√£o do bot√£o voltar
            document.getElementById('btn-voltar-cardapio').onclick = irParaCardapio;

            // Renderiza o estado inicial do carrinho
            renderizarCarrinho();
        };

        document.addEventListener('DOMContentLoaded', inicializarApp);
    </script>
</body>
</html>
